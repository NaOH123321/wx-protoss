"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var cart_model_1 = require("./cart-model");
var cart = new cart_model_1.Cart();
Page({
    data: {
        loadingHidden: false,
        selectedCounts: 0,
        selectedTypeCounts: 0,
        account: 0,
        cartData: []
    },
    onShow: function () {
        var cartData = cart.getCartDataFromLocal();
        var cal = this._calcTotalAccountAndCounts(cartData);
        this.setData({
            selectedCounts: cal.selectedCounts,
            selectedTypeCounts: cal.selectedTypeCounts,
            loadingHidden: true,
            account: cal.account,
            cartData: cartData
        });
    },
    onHide: function () {
        cart.execSetStorageSync(this.data.cartData);
    },
    _calcTotalAccountAndCounts: function (data) {
        var account = 0;
        var selectedCounts = 0;
        var selectedTypeCounts = 0;
        var multiple = 100;
        for (var i = 0; i < data.length; i++) {
            if (data[i].selectStatus) {
                account += data[i].counts * Number(data[i].price) * multiple;
                selectedCounts += data[i].counts;
                selectedTypeCounts++;
            }
        }
        return {
            selectedCounts: selectedCounts,
            selectedTypeCounts: selectedTypeCounts,
            account: account / multiple
        };
    },
    _resetCartData: function () {
        var newData = this._calcTotalAccountAndCounts(this.data.cartData);
        this.setData({
            account: newData.account,
            selectedCounts: newData.selectedCounts,
            selectedTypeCounts: newData.selectedTypeCounts,
            cartData: this.data.cartData
        });
    },
    _getProductIndexById: function (id) {
        var data = this.data.cartData;
        var len = data.length;
        for (var i = 0; i < len; i++) {
            if (data[i].id == id) {
                return i;
            }
        }
        return 0;
    },
    changeCounts: function (event) {
        var id = cart.getDataSet(event, 'id');
        var type = cart.getDataSet(event, 'type');
        var index = this._getProductIndexById(id);
        var counts = 1;
        if (type == 'add') {
            cart.addCounts(id);
        }
        else {
            counts = -1;
            cart.cutCounts(id);
        }
        this.data.cartData[index].counts += counts;
        this._resetCartData();
    },
    delete: function (event) {
        var id = cart.getDataSet(event, 'id');
        var index = this._getProductIndexById(id);
        this.data.cartData.splice(index, 1);
        this._resetCartData();
        cart.delete(id);
    },
    toggleSelect: function (event) {
        var id = cart.getDataSet(event, 'id');
        var status = cart.getDataSet(event, 'status');
        var index = this._getProductIndexById(id);
        this.data.cartData[index].selectStatus = !status;
        this._resetCartData();
    },
    toggleSelectAll: function (event) {
        var status = cart.getDataSet(event, 'status') == 'true';
        var data = this.data.cartData;
        var len = data.length;
        for (var i = 0; i < len; i++) {
            data[i].selectStatus = !status;
        }
        this._resetCartData();
    },
    submitOrder: function () {
        wx.navigateTo({
            url: '../order/order?account=' + this.data.account + '&from=cart'
        });
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FydC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNhcnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwyQ0FBOEM7QUFFOUMsSUFBTSxJQUFJLEdBQUcsSUFBSSxpQkFBSSxFQUFFLENBQUM7QUFFeEIsSUFBSSxDQUFDO0lBQ0gsSUFBSSxFQUFFO1FBQ0osYUFBYSxFQUFFLEtBQUs7UUFDcEIsY0FBYyxFQUFFLENBQUM7UUFDakIsa0JBQWtCLEVBQUUsQ0FBQztRQUNyQixPQUFPLEVBQUUsQ0FBQztRQUNWLFFBQVEsRUFBRSxFQUFnQjtLQUMzQjtJQUNELE1BQU0sRUFBRTtRQUNOLElBQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO1FBQzdDLElBQU0sR0FBRyxHQUFHLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUV0RCxJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osY0FBYyxFQUFFLEdBQUcsQ0FBQyxjQUFjO1lBQ2xDLGtCQUFrQixFQUFFLEdBQUcsQ0FBQyxrQkFBa0I7WUFDMUMsYUFBYSxFQUFFLElBQUk7WUFDbkIsT0FBTyxFQUFFLEdBQUcsQ0FBQyxPQUFPO1lBQ3BCLFFBQVEsRUFBRSxRQUFRO1NBQ25CLENBQUMsQ0FBQztJQUNMLENBQUM7SUFHRCxNQUFNLEVBQUU7UUFDTixJQUFJLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUM5QyxDQUFDO0lBRUQsMEJBQTBCLEVBQUUsVUFBUyxJQUFTO1FBRTVDLElBQUksT0FBTyxHQUFHLENBQUMsQ0FBQztRQUVoQixJQUFJLGNBQWMsR0FBRyxDQUFDLENBQUM7UUFFdkIsSUFBSSxrQkFBa0IsR0FBRyxDQUFDLENBQUM7UUFFM0IsSUFBSSxRQUFRLEdBQUcsR0FBRyxDQUFDO1FBRW5CLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsTUFB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QVMsS0FBVTtRQUMvQixJQUFNLEVBQUUsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN4QyxJQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQztRQUNoRCxJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsb0JBQW9CLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDNUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsWUFBWSxHQUFHLENBQUMsTUFBTSxDQUFDO1FBQ2pELElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUN4QixDQUFDO0lBR0QsZUFBZSxFQUFFLFVBQVMsS0FBVTtRQUNsQyxJQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsSUFBSSxNQUFNLENBQUM7UUFDMUQsSUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUM7UUFDaEMsSUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUN4QixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQzVCLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLEdBQUcsQ0FBQyxNQUFNLENBQUM7U0FDaEM7UUFDRCxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQUdELFdBQVcsRUFBRTtRQUNYLEVBQUUsQ0FBQyxVQUFVLENBQUM7WUFDWixHQUFHLEVBQUUseUJBQXlCLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEdBQUcsWUFBWTtTQUNsRSxDQUFDLENBQUM7SUFDTCxDQUFDO0NBQ0YsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2FydCwgQ2FydEl0ZW0gfSBmcm9tICcuL2NhcnQtbW9kZWwnO1xyXG5cclxuY29uc3QgY2FydCA9IG5ldyBDYXJ0KCk7XHJcblxyXG5QYWdlKHtcclxuICBkYXRhOiB7XHJcbiAgICBsb2FkaW5nSGlkZGVuOiBmYWxzZSxcclxuICAgIHNlbGVjdGVkQ291bnRzOiAwLCAvL+aAu+eahOWVhuWTgeaVsFxyXG4gICAgc2VsZWN0ZWRUeXBlQ291bnRzOiAwLCAvL+aAu+eahOWVhuWTgeexu+Wei+aVsFxyXG4gICAgYWNjb3VudDogMCxcclxuICAgIGNhcnREYXRhOiBbXSBhcyBDYXJ0SXRlbVtdXHJcbiAgfSxcclxuICBvblNob3c6IGZ1bmN0aW9uKCkge1xyXG4gICAgY29uc3QgY2FydERhdGEgPSBjYXJ0LmdldENhcnREYXRhRnJvbUxvY2FsKCk7XHJcbiAgICBjb25zdCBjYWwgPSB0aGlzLl9jYWxjVG90YWxBY2NvdW50QW5kQ291bnRzKGNhcnREYXRhKTtcclxuXHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgc2VsZWN0ZWRDb3VudHM6IGNhbC5zZWxlY3RlZENvdW50cyxcclxuICAgICAgc2VsZWN0ZWRUeXBlQ291bnRzOiBjYWwuc2VsZWN0ZWRUeXBlQ291bnRzLFxyXG4gICAgICBsb2FkaW5nSGlkZGVuOiB0cnVlLFxyXG4gICAgICBhY2NvdW50OiBjYWwuYWNjb3VudCxcclxuICAgICAgY2FydERhdGE6IGNhcnREYXRhXHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICAvKuemu+W8gOmhtemdouaXtu+8jOabtOaWsOacrOWcsOe8k+WtmCovXHJcbiAgb25IaWRlOiBmdW5jdGlvbigpIHtcclxuICAgIGNhcnQuZXhlY1NldFN0b3JhZ2VTeW5jKHRoaXMuZGF0YS5jYXJ0RGF0YSk7XHJcbiAgfSxcclxuXHJcbiAgX2NhbGNUb3RhbEFjY291bnRBbmRDb3VudHM6IGZ1bmN0aW9uKGRhdGE6IGFueSkge1xyXG4gICAgLy8g5omA6ZyA6KaB6K6h566X55qE5oC75Lu35qC877yM5L2G5piv6KaB5rOo5oSP5o6S6Zmk5o6J5pyq6YCJ5Lit55qE5ZWG5ZOBXHJcbiAgICBsZXQgYWNjb3VudCA9IDA7XHJcbiAgICAvLyDotK3kubDllYblk4HnmoTmgLvkuKrmlbBcclxuICAgIGxldCBzZWxlY3RlZENvdW50cyA9IDA7XHJcbiAgICAvLyDotK3kubDllYblk4Hnp43nsbvnmoTmgLvmlbBcclxuICAgIGxldCBzZWxlY3RlZFR5cGVDb3VudHMgPSAwO1xyXG5cclxuICAgIGxldCBtdWx0aXBsZSA9IDEwMDtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgLy/pgb/lhY0gMC4wNSArIDAuMDEgPSAwLjA2MCAwMDAgMDAwIDAwMCAwMDAgMDA1IOeahOmXrumimO+8jOS5mOS7pSAxMDAgKjEwMFxyXG4gICAgICBpZiAoZGF0YVtpXS5zZWxlY3RTdGF0dXMpIHtcclxuICAgICAgICBhY2NvdW50ICs9IGRhdGFbaV0uY291bnRzICogTnVtYmVyKGRhdGFbaV0ucHJpY2UpICogbXVsdGlwbGU7XHJcbiAgICAgICAgc2VsZWN0ZWRDb3VudHMgKz0gZGF0YVtpXS5jb3VudHM7XHJcbiAgICAgICAgc2VsZWN0ZWRUeXBlQ291bnRzKys7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzZWxlY3RlZENvdW50czogc2VsZWN0ZWRDb3VudHMsXHJcbiAgICAgIHNlbGVjdGVkVHlwZUNvdW50czogc2VsZWN0ZWRUeXBlQ291bnRzLFxyXG4gICAgICBhY2NvdW50OiBhY2NvdW50IC8gbXVsdGlwbGVcclxuICAgIH07XHJcbiAgfSxcclxuXHJcbiAgLyrmm7TmlrDotK3nianovabllYblk4HmlbDmja4qL1xyXG4gIF9yZXNldENhcnREYXRhOiBmdW5jdGlvbigpIHtcclxuICAgIHZhciBuZXdEYXRhID0gdGhpcy5fY2FsY1RvdGFsQWNjb3VudEFuZENvdW50cyhcclxuICAgICAgdGhpcy5kYXRhLmNhcnREYXRhXHJcbiAgICApOyAvKumHjeaWsOiuoeeul+aAu+mHkemineWSjOWVhuWTgeaAu+aVsCovXHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgYWNjb3VudDogbmV3RGF0YS5hY2NvdW50LFxyXG4gICAgICBzZWxlY3RlZENvdW50czogbmV3RGF0YS5zZWxlY3RlZENvdW50cyxcclxuICAgICAgc2VsZWN0ZWRUeXBlQ291bnRzOiBuZXdEYXRhLnNlbGVjdGVkVHlwZUNvdW50cyxcclxuICAgICAgY2FydERhdGE6IHRoaXMuZGF0YS5jYXJ0RGF0YVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgLyrmoLnmja7llYblk4FpZOW+l+WIsCDllYblk4HmiYDlnKjkuIvmoIcqL1xyXG4gIF9nZXRQcm9kdWN0SW5kZXhCeUlkOiBmdW5jdGlvbihpZDogbnVtYmVyKSB7XHJcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhLmNhcnREYXRhO1xyXG4gICAgY29uc3QgbGVuID0gZGF0YS5sZW5ndGg7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgIGlmIChkYXRhW2ldLmlkID09IGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiAwO1xyXG4gIH0sXHJcblxyXG4gIC8q6LCD5pW05ZWG5ZOB5pWw55uuKi9cclxuICBjaGFuZ2VDb3VudHM6IGZ1bmN0aW9uKGV2ZW50OiBhbnkpIHtcclxuICAgIGNvbnN0IGlkID0gY2FydC5nZXREYXRhU2V0KGV2ZW50LCAnaWQnKTtcclxuICAgIGNvbnN0IHR5cGUgPSBjYXJ0LmdldERhdGFTZXQoZXZlbnQsICd0eXBlJyk7XHJcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuX2dldFByb2R1Y3RJbmRleEJ5SWQoaWQpO1xyXG4gICAgbGV0IGNvdW50cyA9IDE7XHJcbiAgICBpZiAodHlwZSA9PSAnYWRkJykge1xyXG4gICAgICBjYXJ0LmFkZENvdW50cyhpZCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb3VudHMgPSAtMTtcclxuICAgICAgY2FydC5jdXRDb3VudHMoaWQpO1xyXG4gICAgfVxyXG4gICAgLy/mm7TmlrDllYblk4HpobXpnaJcclxuICAgIHRoaXMuZGF0YS5jYXJ0RGF0YVtpbmRleF0uY291bnRzICs9IGNvdW50cztcclxuICAgIHRoaXMuX3Jlc2V0Q2FydERhdGEoKTtcclxuICB9LFxyXG5cclxuICAvKuWIoOmZpOWVhuWTgSovXHJcbiAgZGVsZXRlOiBmdW5jdGlvbihldmVudDogYW55KSB7XHJcbiAgICBjb25zdCBpZCA9IGNhcnQuZ2V0RGF0YVNldChldmVudCwgJ2lkJyk7XHJcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuX2dldFByb2R1Y3RJbmRleEJ5SWQoaWQpO1xyXG4gICAgdGhpcy5kYXRhLmNhcnREYXRhLnNwbGljZShpbmRleCwgMSk7IC8v5Yig6Zmk5p+Q5LiA6aG55ZWG5ZOBXHJcblxyXG4gICAgdGhpcy5fcmVzZXRDYXJ0RGF0YSgpO1xyXG4gICAgLy90aGlzLnRvZ2dsZVNlbGVjdEFsbCgpO1xyXG5cclxuICAgIGNhcnQuZGVsZXRlKGlkKTsgLy/lhoXlrZjkuK3liKDpmaTor6XllYblk4FcclxuICB9LFxyXG5cclxuICAvKumAieaLqeWVhuWTgSovXHJcbiAgdG9nZ2xlU2VsZWN0OiBmdW5jdGlvbihldmVudDogYW55KSB7XHJcbiAgICBjb25zdCBpZCA9IGNhcnQuZ2V0RGF0YVNldChldmVudCwgJ2lkJyk7XHJcbiAgICBjb25zdCBzdGF0dXMgPSBjYXJ0LmdldERhdGFTZXQoZXZlbnQsICdzdGF0dXMnKTtcclxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5fZ2V0UHJvZHVjdEluZGV4QnlJZChpZCk7XHJcbiAgICB0aGlzLmRhdGEuY2FydERhdGFbaW5kZXhdLnNlbGVjdFN0YXR1cyA9ICFzdGF0dXM7XHJcbiAgICB0aGlzLl9yZXNldENhcnREYXRhKCk7XHJcbiAgfSxcclxuXHJcbiAgLyrlhajpgIkqL1xyXG4gIHRvZ2dsZVNlbGVjdEFsbDogZnVuY3Rpb24oZXZlbnQ6IGFueSkge1xyXG4gICAgY29uc3Qgc3RhdHVzID0gY2FydC5nZXREYXRhU2V0KGV2ZW50LCAnc3RhdHVzJykgPT0gJ3RydWUnO1xyXG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YS5jYXJ0RGF0YTtcclxuICAgIGNvbnN0IGxlbiA9IGRhdGEubGVuZ3RoO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICBkYXRhW2ldLnNlbGVjdFN0YXR1cyA9ICFzdGF0dXM7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9yZXNldENhcnREYXRhKCk7XHJcbiAgfSxcclxuXHJcbiAgLyrmj5DkuqTorqLljZUqL1xyXG4gIHN1Ym1pdE9yZGVyOiBmdW5jdGlvbigpIHtcclxuICAgIHd4Lm5hdmlnYXRlVG8oe1xyXG4gICAgICB1cmw6ICcuLi9vcmRlci9vcmRlcj9hY2NvdW50PScgKyB0aGlzLmRhdGEuYWNjb3VudCArICcmZnJvbT1jYXJ0J1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuIl19