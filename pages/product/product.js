"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var cart_model_1 = require("./../cart/cart-model");
var product_model_1 = require("./product-model");
var product = new product_model_1.Product();
var cart = new cart_model_1.Cart();
Page({
    data: {
        id: 0,
        countsArray: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
        productCount: 1,
        currentTabsIndex: 0,
        product: [],
        cartTotalCounts: 0
    },
    onLoad: function (options) {
        this.data.id = options.id;
        this._loadData();
    },
    _loadData: function () {
        var _this = this;
        product.getDetailInfo(this.data.id, function (data) {
            _this.setData({
                cartTotalCounts: cart.getCartTotalCounts(),
                product: data
            });
        });
    },
    bindPickerChange: function (event) {
        var index = event.detail.value;
        var selectedCount = this.data.countsArray[index];
        this.setData({
            productCount: selectedCount
        });
    },
    onTabsItemTap: function (event) {
        var index = product.getDataSet(event, 'index');
        this.setData({
            currentTabsIndex: index
        });
    },
    onAddingToCartTap: function (event) {
        this.addToCart();
        this.setData({
            cartTotalCounts: cart.getCartTotalCounts()
        });
    },
    addToCart: function () {
        var tempObj = {};
        var keys = ['id', 'name', 'main_img_url', 'price'];
        for (var key in this.data.product) {
            if (keys.indexOf(key) >= 0) {
                tempObj[key] = this.data.product[key];
            }
        }
        cart.add(tempObj, this.data.productCount);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvZHVjdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInByb2R1Y3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxtREFBNEM7QUFDNUMsaURBQTBDO0FBRTFDLElBQU0sT0FBTyxHQUFHLElBQUksdUJBQU8sRUFBRSxDQUFDO0FBQzlCLElBQU0sSUFBSSxHQUFHLElBQUksaUJBQUksRUFBRSxDQUFDO0FBRXhCLElBQUksQ0FBQztJQUNILElBQUksRUFBRTtRQUNKLEVBQUUsRUFBRSxDQUFDO1FBQ0wsV0FBVyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQzVDLFlBQVksRUFBRSxDQUFDO1FBQ2YsZ0JBQWdCLEVBQUUsQ0FBQztRQUNuQixPQUFPLEVBQUUsRUFBRTtRQUNYLGVBQWUsRUFBRSxDQUFDO0tBQ25CO0lBRUQsTUFBTSxFQUFFLFVBQVMsT0FBWTtRQUMzQixJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDO1FBQzFCLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNuQixDQUFDO0lBRUQsU0FBUyxFQUFFO1FBQUEsaUJBT1Y7UUFOQyxPQUFPLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLFVBQUMsSUFBUztZQUM1QyxLQUFJLENBQUMsT0FBUSxDQUFDO2dCQUNaLGVBQWUsRUFBRSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7Z0JBQzFDLE9BQU8sRUFBRSxJQUFJO2FBQ2QsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsZ0JBQWdCLEVBQUUsVUFBUyxLQUFVO1FBQ25DLElBQU0sS0FBSyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO1FBQ2pDLElBQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ25ELElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixZQUFZLEVBQUUsYUFBYTtTQUM1QixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsYUFBYSxFQUFFLFVBQVMsS0FBVTtRQUNoQyxJQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNqRCxJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osZ0JBQWdCLEVBQUUsS0FBSztTQUN4QixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsaUJBQWlCLEVBQUUsVUFBUyxLQUFVO1FBQ3BDLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNqQixJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osZUFBZSxFQUFFLElBQUksQ0FBQyxrQkFBa0IsRUFBRTtTQUMzQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsU0FBUyxFQUFFO1FBQ1QsSUFBTSxPQUFPLEdBQVEsRUFBRSxDQUFDO1FBQ3hCLElBQU0sSUFBSSxHQUFHLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxjQUFjLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFFckQsS0FBSyxJQUFNLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNuQyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFO2dCQUMxQixPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDdkM7U0FDRjtRQUVELElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDNUMsQ0FBQztDQUNGLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENhcnQgfSBmcm9tICcuLy4uL2NhcnQvY2FydC1tb2RlbCc7XHJcbmltcG9ydCB7IFByb2R1Y3QgfSBmcm9tICcuL3Byb2R1Y3QtbW9kZWwnO1xyXG5cclxuY29uc3QgcHJvZHVjdCA9IG5ldyBQcm9kdWN0KCk7XHJcbmNvbnN0IGNhcnQgPSBuZXcgQ2FydCgpO1xyXG5cclxuUGFnZSh7XHJcbiAgZGF0YToge1xyXG4gICAgaWQ6IDAsXHJcbiAgICBjb3VudHNBcnJheTogWzEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwXSxcclxuICAgIHByb2R1Y3RDb3VudDogMSxcclxuICAgIGN1cnJlbnRUYWJzSW5kZXg6IDAsXHJcbiAgICBwcm9kdWN0OiBbXSxcclxuICAgIGNhcnRUb3RhbENvdW50czogMFxyXG4gIH0sXHJcblxyXG4gIG9uTG9hZDogZnVuY3Rpb24ob3B0aW9uczogYW55KSB7XHJcbiAgICB0aGlzLmRhdGEuaWQgPSBvcHRpb25zLmlkO1xyXG4gICAgdGhpcy5fbG9hZERhdGEoKTtcclxuICB9LFxyXG5cclxuICBfbG9hZERhdGE6IGZ1bmN0aW9uKCkge1xyXG4gICAgcHJvZHVjdC5nZXREZXRhaWxJbmZvKHRoaXMuZGF0YS5pZCwgKGRhdGE6IGFueSkgPT4ge1xyXG4gICAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgICBjYXJ0VG90YWxDb3VudHM6IGNhcnQuZ2V0Q2FydFRvdGFsQ291bnRzKCksXHJcbiAgICAgICAgcHJvZHVjdDogZGF0YVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIGJpbmRQaWNrZXJDaGFuZ2U6IGZ1bmN0aW9uKGV2ZW50OiBhbnkpIHtcclxuICAgIGNvbnN0IGluZGV4ID0gZXZlbnQuZGV0YWlsLnZhbHVlO1xyXG4gICAgY29uc3Qgc2VsZWN0ZWRDb3VudCA9IHRoaXMuZGF0YS5jb3VudHNBcnJheVtpbmRleF07XHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgcHJvZHVjdENvdW50OiBzZWxlY3RlZENvdW50XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBvblRhYnNJdGVtVGFwOiBmdW5jdGlvbihldmVudDogYW55KSB7XHJcbiAgICBjb25zdCBpbmRleCA9IHByb2R1Y3QuZ2V0RGF0YVNldChldmVudCwgJ2luZGV4Jyk7XHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgY3VycmVudFRhYnNJbmRleDogaW5kZXhcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIG9uQWRkaW5nVG9DYXJ0VGFwOiBmdW5jdGlvbihldmVudDogYW55KSB7XHJcbiAgICB0aGlzLmFkZFRvQ2FydCgpO1xyXG4gICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgIGNhcnRUb3RhbENvdW50czogY2FydC5nZXRDYXJ0VG90YWxDb3VudHMoKVxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgYWRkVG9DYXJ0OiBmdW5jdGlvbigpIHtcclxuICAgIGNvbnN0IHRlbXBPYmo6IGFueSA9IHt9O1xyXG4gICAgY29uc3Qga2V5cyA9IFsnaWQnLCAnbmFtZScsICdtYWluX2ltZ191cmwnLCAncHJpY2UnXTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLmRhdGEucHJvZHVjdCkge1xyXG4gICAgICBpZiAoa2V5cy5pbmRleE9mKGtleSkgPj0gMCkge1xyXG4gICAgICAgIHRlbXBPYmpba2V5XSA9IHRoaXMuZGF0YS5wcm9kdWN0W2tleV07XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjYXJ0LmFkZCh0ZW1wT2JqLCB0aGlzLmRhdGEucHJvZHVjdENvdW50KTtcclxuICB9XHJcbn0pO1xyXG4iXX0=