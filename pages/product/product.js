"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var cart_model_1 = require("./../cart/cart-model");
var product_model_1 = require("./product-model");
var product = new product_model_1.Product();
var cart = new cart_model_1.Cart();
Page({
    data: {
        id: 0,
        countsArray: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
        productCount: 1,
        currentTabsIndex: 0,
        product: [],
        cartTotalCounts: 0
    },
    onLoad: function (options) {
        this.data.id = options.id;
        this._loadData();
    },
    _loadData: function () {
        var _this = this;
        product.getDetailInfo(this.data.id, function (data) {
            _this.setData({
                cartTotalCounts: cart.getCartTotalCounts(),
                product: data
            });
        });
    },
    bindPickerChange: function (event) {
        var index = event.detail.value;
        var selectedCount = this.data.countsArray[index];
        this.setData({
            productCount: selectedCount
        });
    },
    onTabsItemTap: function (event) {
        var index = product.getDataSet(event, 'index');
        this.setData({
            currentTabsIndex: index
        });
    },
    onAddingToCartTap: function (event) {
        this.addToCart();
        this.setData({
            cartTotalCounts: cart.getCartTotalCounts()
        });
    },
    addToCart: function () {
        var tempObj = {};
        var keys = ['id', 'name', 'main_img_url', 'price'];
        for (var key in this.data.product) {
            if (keys.indexOf(key) >= 0) {
                tempObj[key] = this.data.product[key];
            }
        }
        cart.add(tempObj, this.data.productCount);
    },
    onCartTap: function () {
        wx.switchTab({
            url: '/pages/cart/cart'
        });
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvZHVjdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInByb2R1Y3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxtREFBNEM7QUFDNUMsaURBQTBDO0FBRTFDLElBQU0sT0FBTyxHQUFHLElBQUksdUJBQU8sRUFBRSxDQUFDO0FBQzlCLElBQU0sSUFBSSxHQUFHLElBQUksaUJBQUksRUFBRSxDQUFDO0FBRXhCLElBQUksQ0FBQztJQUNILElBQUksRUFBRTtRQUNKLEVBQUUsRUFBRSxDQUFDO1FBQ0wsV0FBVyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQzVDLFlBQVksRUFBRSxDQUFDO1FBQ2YsZ0JBQWdCLEVBQUUsQ0FBQztRQUNuQixPQUFPLEVBQUUsRUFBRTtRQUNYLGVBQWUsRUFBRSxDQUFDO0tBQ25CO0lBRUQsTUFBTSxFQUFFLFVBQVMsT0FBWTtRQUMzQixJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDO1FBQzFCLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNuQixDQUFDO0lBRUQsU0FBUyxFQUFFO1FBQUEsaUJBT1Y7UUFOQyxPQUFPLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLFVBQUMsSUFBUztZQUM1QyxLQUFJLENBQUMsT0FBUSxDQUFDO2dCQUNaLGVBQWUsRUFBRSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7Z0JBQzFDLE9BQU8sRUFBRSxJQUFJO2FBQ2QsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsZ0JBQWdCLEVBQUUsVUFBUyxLQUFVO1FBQ25DLElBQU0sS0FBSyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO1FBQ2pDLElBQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ25ELElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixZQUFZLEVBQUUsYUFBYTtTQUM1QixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsYUFBYSxFQUFFLFVBQVMsS0FBVTtRQUNoQyxJQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNqRCxJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osZ0JBQWdCLEVBQUUsS0FBSztTQUN4QixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsaUJBQWlCLEVBQUUsVUFBUyxLQUFVO1FBQ3BDLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNqQixJQUFJLENBQUMsT0FBUSxDQUFDO1lBQ1osZUFBZSxFQUFFLElBQUksQ0FBQyxrQkFBa0IsRUFBRTtTQUMzQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsU0FBUyxFQUFFO1FBQ1QsSUFBTSxPQUFPLEdBQVEsRUFBRSxDQUFDO1FBQ3hCLElBQU0sSUFBSSxHQUFHLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxjQUFjLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFFckQsS0FBSyxJQUFNLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNuQyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFO2dCQUMxQixPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDdkM7U0FDRjtRQUVELElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUdELFNBQVMsRUFBRTtRQUNULEVBQUUsQ0FBQyxTQUFTLENBQUM7WUFDWCxHQUFHLEVBQUUsa0JBQWtCO1NBQ3hCLENBQUMsQ0FBQztJQUNMLENBQUM7Q0FDRixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDYXJ0IH0gZnJvbSAnLi8uLi9jYXJ0L2NhcnQtbW9kZWwnO1xyXG5pbXBvcnQgeyBQcm9kdWN0IH0gZnJvbSAnLi9wcm9kdWN0LW1vZGVsJztcclxuXHJcbmNvbnN0IHByb2R1Y3QgPSBuZXcgUHJvZHVjdCgpO1xyXG5jb25zdCBjYXJ0ID0gbmV3IENhcnQoKTtcclxuXHJcblBhZ2Uoe1xyXG4gIGRhdGE6IHtcclxuICAgIGlkOiAwLFxyXG4gICAgY291bnRzQXJyYXk6IFsxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMF0sXHJcbiAgICBwcm9kdWN0Q291bnQ6IDEsXHJcbiAgICBjdXJyZW50VGFic0luZGV4OiAwLFxyXG4gICAgcHJvZHVjdDogW10sXHJcbiAgICBjYXJ0VG90YWxDb3VudHM6IDBcclxuICB9LFxyXG5cclxuICBvbkxvYWQ6IGZ1bmN0aW9uKG9wdGlvbnM6IGFueSkge1xyXG4gICAgdGhpcy5kYXRhLmlkID0gb3B0aW9ucy5pZDtcclxuICAgIHRoaXMuX2xvYWREYXRhKCk7XHJcbiAgfSxcclxuXHJcbiAgX2xvYWREYXRhOiBmdW5jdGlvbigpIHtcclxuICAgIHByb2R1Y3QuZ2V0RGV0YWlsSW5mbyh0aGlzLmRhdGEuaWQsIChkYXRhOiBhbnkpID0+IHtcclxuICAgICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgICAgY2FydFRvdGFsQ291bnRzOiBjYXJ0LmdldENhcnRUb3RhbENvdW50cygpLFxyXG4gICAgICAgIHByb2R1Y3Q6IGRhdGFcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBiaW5kUGlja2VyQ2hhbmdlOiBmdW5jdGlvbihldmVudDogYW55KSB7XHJcbiAgICBjb25zdCBpbmRleCA9IGV2ZW50LmRldGFpbC52YWx1ZTtcclxuICAgIGNvbnN0IHNlbGVjdGVkQ291bnQgPSB0aGlzLmRhdGEuY291bnRzQXJyYXlbaW5kZXhdO1xyXG4gICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgIHByb2R1Y3RDb3VudDogc2VsZWN0ZWRDb3VudFxyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgb25UYWJzSXRlbVRhcDogZnVuY3Rpb24oZXZlbnQ6IGFueSkge1xyXG4gICAgY29uc3QgaW5kZXggPSBwcm9kdWN0LmdldERhdGFTZXQoZXZlbnQsICdpbmRleCcpO1xyXG4gICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgIGN1cnJlbnRUYWJzSW5kZXg6IGluZGV4XHJcbiAgICB9KTtcclxuICB9LFxyXG5cclxuICBvbkFkZGluZ1RvQ2FydFRhcDogZnVuY3Rpb24oZXZlbnQ6IGFueSkge1xyXG4gICAgdGhpcy5hZGRUb0NhcnQoKTtcclxuICAgIHRoaXMuc2V0RGF0YSEoe1xyXG4gICAgICBjYXJ0VG90YWxDb3VudHM6IGNhcnQuZ2V0Q2FydFRvdGFsQ291bnRzKClcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIGFkZFRvQ2FydDogZnVuY3Rpb24oKSB7XHJcbiAgICBjb25zdCB0ZW1wT2JqOiBhbnkgPSB7fTtcclxuICAgIGNvbnN0IGtleXMgPSBbJ2lkJywgJ25hbWUnLCAnbWFpbl9pbWdfdXJsJywgJ3ByaWNlJ107XHJcblxyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5kYXRhLnByb2R1Y3QpIHtcclxuICAgICAgaWYgKGtleXMuaW5kZXhPZihrZXkpID49IDApIHtcclxuICAgICAgICB0ZW1wT2JqW2tleV0gPSB0aGlzLmRhdGEucHJvZHVjdFtrZXldO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2FydC5hZGQodGVtcE9iaiwgdGhpcy5kYXRhLnByb2R1Y3RDb3VudCk7XHJcbiAgfSxcclxuXHJcbiAgLyrot7PovazliLDotK3nianovaYqL1xyXG4gIG9uQ2FydFRhcDogZnVuY3Rpb24oKSB7XHJcbiAgICB3eC5zd2l0Y2hUYWIoe1xyXG4gICAgICB1cmw6ICcvcGFnZXMvY2FydC9jYXJ0J1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuIl19